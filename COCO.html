<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Agribusiness Product Advertisement</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap");
    :root {
      color-scheme: light;
    }
    body {
      background: linear-gradient(120deg, #f68b1e 0%, #f5f5f5 100%);
      color: #232323;
      min-height: 100vh;
      font-size: 1.05rem;
      background-attachment: fixed;
      background-repeat: no-repeat;
      background-size: cover;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    .container {
      max-width: 980px;
      margin: 2.5rem auto;
      box-shadow: 0 12px 40px rgba(35, 35, 35, 0.12);
      border-radius: 26px;
      background: rgba(255, 255, 255, 0.98);
      padding: 3rem 2.5rem;
      transition: box-shadow 0.2s, transform 0.2s;
    }
    .container:hover {
      box-shadow: 0 18px 56px rgba(246, 139, 30, 0.22);
      transform: translateY(-4px);
    }
    .hero-card {
      background: linear-gradient(155deg, rgba(246, 139, 30, 0.12), rgba(255, 255, 255, 0.95));
      border-radius: 24px;
      padding: 2.2rem 2rem;
      display: flex;
      gap: 2.5rem;
      align-items: center;
      justify-content: space-between;
    }
    .hero-card h1 {
      color: #f68b1e;
      font-weight: 700;
      letter-spacing: 0.4px;
      margin-bottom: 1rem;
    }
    .hero-subtitle {
      color: #5b5b5b;
      max-width: 32rem;
    }
    .hero-stats {
      display: flex;
      gap: 1.5rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }
    .hero-stat {
      background: rgba(255, 255, 255, 0.65);
      border-radius: 16px;
      padding: 0.85rem 1rem;
      min-width: 140px;
      text-align: left;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }
    .hero-stat-number {
      display: block;
      font-size: 1.5rem;
      font-weight: 700;
      color: #232323;
    }
    .hero-stat-label {
      font-size: 0.85rem;
      color: #6b6b6b;
      letter-spacing: 0.4px;
    }
    .hero-cta {
      max-width: 260px;
      text-align: right;
    }
    .hero-cta-text {
      color: #5b5b5b;
    }
    .feature-deck {
      background: #fff8f0;
      border-radius: 20px;
      padding: 2rem 1.5rem;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }
    .feature-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    .feature-title {
      font-size: 1.65rem;
      font-weight: 600;
      color: #d97706;
      margin-bottom: 0.35rem;
    }
    .feature-summary {
      max-width: 420px;
      color: #6b6b6b;
    }
    .feature-tabs {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .feature-tabs .btn {
      border-radius: 999px;
      border-width: 2px;
      font-weight: 600;
      padding: 0.4rem 1.1rem;
      color: #f68b1e;
      border-color: rgba(246, 139, 30, 0.35);
      transition: all 0.2s ease;
    }
    .feature-tabs .btn.active,
    .feature-tabs .btn:hover {
      background: #f68b1e;
      color: #fff;
      border-color: #f68b1e;
      box-shadow: 0 8px 20px rgba(246, 139, 30, 0.18);
    }
    .feature-card {
      background: #fff;
      border-radius: 18px;
      border: 0;
      box-shadow: 0 6px 18px rgba(35, 35, 35, 0.08);
      padding: 1.5rem 1.3rem;
      transition: transform 0.18s ease, box-shadow 0.2s ease;
      cursor: pointer;
    }
    .feature-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 12px 28px rgba(246, 139, 30, 0.18);
    }
    .feature-card--active {
      outline: 3px solid rgba(246, 139, 30, 0.4);
      box-shadow: 0 14px 32px rgba(246, 139, 30, 0.28);
      transform: translateY(-8px);
    }
    .icon-wrapper {
      width: 64px;
      height: 64px;
      border-radius: 18px;
      display: grid;
      place-items: center;
      margin-bottom: 1rem;
    }
    .icon-wrapper.bg-soft-warning { background: rgba(246, 139, 30, 0.1); color: #f68b1e; }
    .icon-wrapper.bg-soft-info { background: rgba(13, 110, 253, 0.12); color: #0d6efd; }
    .icon-wrapper.bg-soft-secondary { background: rgba(108, 117, 125, 0.12); color: #6c757d; }
    .icon-wrapper.bg-soft-success { background: rgba(25, 135, 84, 0.12); color: #198754; }
    .feature-card h6 {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 0.35rem;
    }
    .feature-card p {
      color: #6b6b6b;
      font-size: 0.95rem;
    }
    .animate-in {
      animation: fadeSlideIn 0.35s ease;
    }
    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .form-section {
      background: #fff8f0;
      border-radius: 18px;
      padding: 1.8rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 12px rgba(246, 139, 30, 0.18);
      transition: box-shadow 0.2s;
    }
    .form-section-title {
      font-size: 1.18rem;
      font-weight: 600;
      color: #d97706;
      margin-bottom: 1.1rem;
      letter-spacing: 0.45px;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .btn-primary { background: #f68b1e; border: none; }
    .btn-primary:hover, .btn-primary:focus { background: #d97706; }
    .btn-warning { background: #fff3cd; color: #d97706; border: none; }
    .btn-warning:hover { background: #ffe6b3; color: #f68b1e; }
    .card-img-top, .carousel-item img { max-height: 250px; object-fit: cover; }
    .preview-card { margin-top: 2rem; }
    .alert-success { margin-top: 1rem; }
    .tag-badge { margin-right: 4px; }
    .share-btns .btn { margin-right: 6px; margin-bottom: 6px; }
    .modal-content { border-radius: 16px; }
    .modal-header { background: #f68b1e; color: #fff; border-radius: 16px 16px 0 0; }
    .spinner-border { width: 1.5rem; height: 1.5rem; }
    @media (max-width: 1024px) {
      .container { padding: 2.2rem 1.2rem; }
      .hero-card { flex-direction: column; text-align: center; }
      .hero-cta { text-align: center; max-width: none; }
      .hero-stats { justify-content: center; }
      .feature-header { flex-direction: column; align-items: flex-start; }
      .feature-tabs { width: 100%; }
    }
    @media (max-width: 768px) {
      body { font-size: 1rem; }
      .container { border-radius: 18px; }
      .hero-card { padding: 1.8rem 1.4rem; }
      .feature-deck { padding: 1.6rem 1.2rem; }
      .form-section { padding: 1.4rem; }
    }
    @media (max-width: 600px) {
      .container { padding: 1.4rem 0.8rem; margin: 1.6rem auto; }
      .feature-tabs { gap: 0.4rem; }
      .feature-tabs .btn { flex: 1 1 calc(50% - 0.4rem); text-align: center; }
      .feature-card { padding: 1.2rem; }
      .hero-card h1 { font-size: clamp(1.4rem, 6vw, 2rem); }
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <header class="hero-card mb-4 shadow-sm">
      <div class="hero-text">
        <span class="badge rounded-pill bg-warning-subtle text-warning-emphasis mb-2">Agribusiness Suite</span>
        <h1>Reimagine your farm marketplace</h1>
        <p class="hero-subtitle">Organize your listings, nurture buyer trust, and close confident deals with responsive tools built for modern agritrade.</p>
        <div class="hero-stats">
          <div class="hero-stat">
            <span class="hero-stat-number">4.7★</span>
            <span class="hero-stat-label">Seller rating</span>
          </div>
          <div class="hero-stat">
            <span class="hero-stat-number">12</span>
            <span class="hero-stat-label">Live chats today</span>
          </div>
          <div class="hero-stat">
            <span class="hero-stat-number">3</span>
            <span class="hero-stat-label">Smart filters</span>
          </div>
        </div>
      </div>
      <div class="hero-cta">
        <p class="hero-cta-text">Use the feature tabs to explore how buyers discover, review, and purchase your stock.</p>
        <button type="button" class="btn btn-primary btn-lg mt-2" id="heroPreviewBtn">
          <i class="bi bi-magic"></i> Start a preview
        </button>
      </div>
    </header>

    <section class="feature-deck mb-5">
      <div class="feature-header">
        <div>
          <h3 class="feature-title">Marketplace features</h3>
          <p class="feature-summary mb-0" id="featureSummary">Tap a card to learn how each capability supports your storefront.</p>
        </div>
        <div class="feature-tabs" id="featureTabs" role="tablist" aria-label="Feature filter">
          <button type="button" class="btn btn-outline-primary active" data-feature-target="all" aria-pressed="true">All</button>
          <button type="button" class="btn btn-outline-primary" data-feature-target="engagement" aria-pressed="false">Engagement</button>
          <button type="button" class="btn btn-outline-primary" data-feature-target="commerce" aria-pressed="false">Commerce</button>
          <button type="button" class="btn btn-outline-primary" data-feature-target="insights" aria-pressed="false">Insights</button>
        </div>
      </div>
      <div class="row g-4" id="featureGrid">
        <div class="col-12 col-md-6 col-lg-3 animate-in" data-feature-group="engagement" data-feature-title="Ratings &amp; Reviews" data-feature-copy="Capture authentic buyer feedback and boost trust instantly.">
          <div class="card feature-card h-100 text-center position-relative">
            <div class="icon-wrapper bg-soft-warning mx-auto">
              <i class="bi bi-star-fill fs-2"></i>
            </div>
            <div class="card-body p-0 d-flex flex-column align-items-center">
              <div class="d-flex align-items-center justify-content-center mb-2">
                <span class="fs-4 fw-bold text-warning" id="avgRating">4.7</span>
              </div>
              <h6 class="text-primary">Ratings &amp; Reviews</h6>
              <p class="text-muted mb-2">Rate products and leave feedback for sellers.</p>
              <div class="mb-3">
                <span class="badge bg-success">245 Reviews</span>
              </div>
              <button id="openReviewBtn" class="btn btn-warning btn-sm mt-auto"><i class="bi bi-star"></i> Rate &amp; Review</button>
              <div class="mt-3 w-100" id="recentReviews"></div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3 animate-in" data-feature-group="engagement" data-feature-title="Real-time messaging" data-feature-copy="Stay in sync with buyers using in-app messaging threads.">
          <div class="card feature-card h-100 text-center position-relative">
            <div class="icon-wrapper bg-soft-info mx-auto">
              <i class="bi bi-chat-dots fs-2"></i>
            </div>
            <div class="card-body p-0 d-flex flex-column align-items-center">
              <div class="d-flex align-items-center justify-content-center mb-2">
                <span class="fs-4 fw-bold text-info" id="msgCount">12</span>
              </div>
              <h6 class="text-info">Messaging</h6>
              <p class="text-muted mb-2">Chat directly with sellers and buyers.</p>
              <div class="mb-3">
                <span class="badge bg-info text-dark">New Messages</span>
              </div>
              <button id="openChatBtn" class="btn btn-info btn-sm mt-auto text-white"><i class="bi bi-chat-dots"></i> Message</button>
              <div class="mt-3 w-100" id="recentMessages" style="max-height:60px;overflow-y:auto;"></div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3 animate-in" data-feature-group="insights" data-feature-title="Smart filtering" data-feature-copy="Guide buyers to the right inventory with precise filtering controls.">
          <div class="card feature-card h-100 text-center position-relative">
            <div class="icon-wrapper bg-soft-secondary mx-auto">
              <i class="bi bi-filter fs-2"></i>
            </div>
            <div class="card-body p-0 d-flex flex-column align-items-center justify-content-center">
              <h6 class="text-secondary">Product Filtering</h6>
              <p class="text-muted mb-3">Filter products by category, price, and location to focus on the right leads.</p>
              <span class="badge bg-secondary-subtle text-secondary-emphasis">Multi-criteria ready</span>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3 animate-in" data-feature-group="commerce" data-feature-title="Payment simulations" data-feature-copy="Run smooth demo checkouts to build confidence before launch.">
          <div class="card feature-card h-100 text-center position-relative">
            <div class="icon-wrapper bg-soft-success mx-auto">
              <i class="bi bi-credit-card fs-2"></i>
            </div>
            <div class="card-body p-0 d-flex flex-column align-items-center">
              <h6 class="text-success">Payment Demo</h6>
              <p class="text-muted mb-3">Simulate secure payments for orders to show buyers what to expect.</p>
              <button id="payBtn" class="btn btn-success btn-sm mt-auto"><i class="bi bi-credit-card"></i> Pay</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Product Filter Bar -->
    <section class="mb-4" id="filterBar">
      <div class="row g-3">
        <div class="col-12 col-md-3">
          <select id="filterCategory" class="form-select form-select-sm">
            <option value="">All Categories</option>
            <option value="Tractors">Tractors</option>
            <option value="Implements">Implements</option>
            <option value="Seeds">Seeds</option>
            <option value="Fertilizer">Fertilizer</option>
            <option value="Tools">Tools</option>
            <option value="Produce">Produce</option>
          </select>
        </div>
        <div class="col-12 col-md-3">
          <input id="filterLocation" class="form-control form-control-sm" placeholder="Location">
        </div>
        <div class="col-12 col-md-3">
          <input id="filterPrice" class="form-control form-control-sm" type="number" min="0" placeholder="Max Price">
        </div>
        <div class="col-12 col-md-3">
          <button id="applyFilterBtn" class="btn btn-sm btn-primary w-100"><i class="bi bi-funnel"></i> Filter</button>
        </div>
      </div>
    </section>

    <ul class="nav nav-tabs mb-4" id="adTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="basic-tab" data-bs-toggle="tab" data-bs-target="#basic-pane" type="button" role="tab" aria-controls="basic-pane" aria-selected="true">
          <i class="bi bi-info-circle"></i> Basic Info
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pricing-tab" data-bs-toggle="tab" data-bs-target="#pricing-pane" type="button" role="tab" aria-controls="pricing-pane" aria-selected="false">
          <i class="bi bi-cash-coin"></i> Pricing & Stock
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="media-tab" data-bs-toggle="tab" data-bs-target="#media-pane" type="button" role="tab" aria-controls="media-pane" aria-selected="false">
          <i class="bi bi-images"></i> Media & Gallery
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact-pane" type="button" role="tab" aria-controls="contact-pane" aria-selected="false">
          <i class="bi bi-person-lines-fill"></i> Seller Contact
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="preview-tab" data-bs-toggle="tab" data-bs-target="#preview-pane" type="button" role="tab" aria-controls="preview-pane" aria-selected="false">
          <i class="bi bi-eye-fill"></i> Preview & Share
        </button>
      </li>
    </ul>

    <form id="ad-form" class="needs-validation" novalidate>
      <div class="tab-content" id="adTabsContent">
        <div class="tab-pane fade show active" id="basic-pane" role="tabpanel" aria-labelledby="basic-tab">
          <div class="form-section">
            <div class="form-section-title"><i class="bi bi-info-circle"></i> Product Overview</div>
            <div class="mb-3">
              <label for="prod-name" class="form-label">Product Name <span class="text-danger">*</span></label>
              <input id="prod-name" name="prod-name" class="form-control" required placeholder="e.g. Massey Ferguson Tractor" />
              <div class="invalid-feedback">Please enter a product name.</div>
            </div>
            <div class="mb-3">
              <label for="prod-category" class="form-label">Category <span class="text-danger">*</span></label>
              <select id="prod-category" name="prod-category" class="form-select" required>
                <option value="">Select category</option>
                <option value="Tractors">Tractors</option>
                <option value="Implements">Implements</option>
                <option value="Seeds">Seeds</option>
                <option value="Fertilizer">Fertilizer</option>
                <option value="Tools">Tools</option>
                <option value="Produce">Produce</option>
                <option value="Other">Other</option>
              </select>
              <div class="invalid-feedback">Please select a category.</div>
            </div>
            <div class="mb-3">
              <label for="prod-desc" class="form-label">Description <span class="text-danger">*</span></label>
              <textarea id="prod-desc" name="prod-desc" rows="3" class="form-control" required placeholder="Describe your product, features, and benefits"></textarea>
              <div class="invalid-feedback">Please enter a description.</div>
            </div>
            <div class="mb-3">
              <label for="prod-condition" class="form-label">Condition <span class="text-danger">*</span></label>
              <select id="prod-condition" name="prod-condition" class="form-select" required>
                <option value="">Select condition</option>
                <option value="New">New</option>
                <option value="Used">Used</option>
                <option value="Refurbished">Refurbished</option>
              </select>
              <div class="invalid-feedback">Please select product condition.</div>
            </div>
            <div class="mb-3">
              <label for="prod-location" class="form-label">Location <span class="text-danger">*</span></label>
              <input id="prod-location" name="prod-location" class="form-control" required placeholder="e.g. Kampala, Uganda" />
              <div class="invalid-feedback">Please enter the product location.</div>
            </div>
            <div class="mb-3">
              <label for="prod-tags" class="form-label">Tags / Keywords</label>
              <input id="prod-tags" name="prod-tags" class="form-control" placeholder="e.g. maize, tractor, organic" />
            </div>
            <div class="mb-3">
              <label for="prod-expiry" class="form-label">Advert Expiry Date <span class="text-danger">*</span></label>
              <input id="prod-expiry" name="prod-expiry" type="date" class="form-control" required />
              <div class="invalid-feedback">Please select expiry date.</div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="pricing-pane" role="tabpanel" aria-labelledby="pricing-tab">
          <div class="form-section">
            <div class="form-section-title"><i class="bi bi-cash-coin"></i> Pricing & Stock</div>
            <div class="mb-3">
              <label for="prod-price" class="form-label">Price (UGX) <span class="text-danger">*</span></label>
              <input id="prod-price" name="prod-price" type="number" min="0" class="form-control" required placeholder="e.g. 35000000" />
              <div class="invalid-feedback">Please enter a valid price.</div>
            </div>
            <div class="mb-3 form-check">
              <input type="checkbox" class="form-check-input" id="prod-negotiable" name="prod-negotiable">
              <label class="form-check-label" for="prod-negotiable">Price Negotiable</label>
            </div>
            <div class="mb-3">
              <label for="prod-quantity" class="form-label">Quantity / Stock <span class="text-danger">*</span></label>
              <input id="prod-quantity" name="prod-quantity" type="number" min="1" class="form-control" required placeholder="e.g. 5" />
              <div class="invalid-feedback">Please enter available quantity.</div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="media-pane" role="tabpanel" aria-labelledby="media-tab">
          <div class="form-section">
            <div class="form-section-title"><i class="bi bi-images"></i> Media & Gallery</div>
            <div class="mb-3">
              <label for="prod-img" class="form-label">Product Images</label>
              <input id="prod-img" name="prod-img" type="file" accept="image/*" class="form-control" multiple />
              <div class="form-text">Upload clear images of your product (multiple allowed).</div>
            </div>
            <div class="mb-3">
              <label for="prod-video" class="form-label">Product Video</label>
              <input id="prod-video" name="prod-video" type="file" accept="video/*" class="form-control" />
              <div class="form-text">Upload a short video (optional).</div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="contact-pane" role="tabpanel" aria-labelledby="contact-tab">
          <div class="form-section">
            <div class="form-section-title"><i class="bi bi-person-lines-fill"></i> Seller Contact</div>
            <div class="mb-3">
              <label for="contact-name" class="form-label">Seller Name <span class="text-danger">*</span></label>
              <input id="contact-name" name="contact-name" class="form-control" required placeholder="e.g. John Doe" />
              <div class="invalid-feedback">Please enter your name.</div>
            </div>
            <div class="mb-3">
              <label for="contact-phone" class="form-label">Contact Phone <span class="text-danger">*</span></label>
              <input id="contact-phone" name="contact-phone" type="tel" class="form-control" pattern=".{9,}" required placeholder="e.g. +256700000000" />
              <div class="invalid-feedback">Please enter a valid phone number.</div>
            </div>
            <div class="mb-3">
              <label for="contact-email" class="form-label">Contact Email <span class="text-danger">*</span></label>
              <input id="contact-email" name="contact-email" type="email" class="form-control" required placeholder="e.g. seller@email.com" />
              <div class="invalid-feedback">Please enter a valid email address.</div>
            </div>
            <div class="mb-3">
              <label for="contact-whatsapp" class="form-label">WhatsApp Number</label>
              <input id="contact-whatsapp" name="contact-whatsapp" type="tel" class="form-control" placeholder="e.g. +256700000000" />
              <div class="form-text">Optional: For WhatsApp chat button.</div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="preview-pane" role="tabpanel" aria-labelledby="preview-tab">
          <div id="preview" class="preview-card" style="display:none;">
            <h4 class="mb-3 text-center"><i class="bi bi-eye-fill"></i> Product Preview</h4>
            <div class="card shadow-sm">
              <div id="preview-carousel" class="carousel slide" data-bs-ride="carousel" style="display:none;">
                <div class="carousel-inner" id="carousel-inner"></div>
                <button class="carousel-control-prev" type="button" data-bs-target="#preview-carousel" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#preview-carousel" data-bs-slide="next">
                  <span class="carousel-control-next-icon"></span>
                </button>
              </div>
              <img id="preview-img" class="card-img-top" alt="Product Image" style="display:none;" />
              <div class="card-body">
                <h5 class="card-title" id="preview-name"></h5>
                <div class="mb-2"><span class="badge bg-info" id="preview-category"></span></div>
                <div class="mb-2"><span class="badge bg-secondary" id="preview-condition"></span></div>
                <div class="mb-2"><strong>Location:</strong> <span id="preview-location"></span></div>
                <div class="mb-2"><strong>Quantity:</strong> <span id="preview-quantity"></span></div>
                <p class="card-text" id="preview-desc"></p>
                <p class="fw-bold text-success mb-2">UGX <span id="preview-price"></span>
                  <span id="preview-negotiable" class="badge bg-warning text-dark" style="display:none;">Negotiable</span>
                </p>
                <div class="mb-2"><strong>Tags:</strong> <span id="preview-tags"></span></div>
                <div class="mb-2"><strong>Expiry Date:</strong> <span id="preview-expiry"></span></div>
                <div class="mb-2"><strong>Contact Phone:</strong> <span id="preview-phone"></span>
                  <a id="preview-whatsapp" class="btn btn-success btn-sm ms-2" target="_blank" style="display:none;" data-bs-toggle="tooltip" title="Chat on WhatsApp">
                    <i class="bi bi-whatsapp"></i> WhatsApp
                  </a>
                </div>
                <div class="mb-2"><strong>Contact Email:</strong> <span id="preview-email"></span></div>
                <div class="mb-3" id="preview-video-container" style="display:none;">
                  <video id="preview-video" controls style="width:100%;border-radius:8px;"></video>
                </div>
                <div class="share-btns mt-3">
                  <span>Share:</span>
                  <button type="button" class="btn btn-outline-primary btn-sm" id="share-facebook" data-bs-toggle="tooltip" title="Share on Facebook"><i class="bi bi-facebook"></i></button>
                  <button type="button" class="btn btn-outline-info btn-sm" id="share-twitter" data-bs-toggle="tooltip" title="Share on Twitter"><i class="bi bi-twitter"></i></button>
                  <button type="button" class="btn btn-outline-success btn-sm" id="share-whatsapp" data-bs-toggle="tooltip" title="Share on WhatsApp"><i class="bi bi-whatsapp"></i></button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="d-flex gap-2 justify-content-center mt-3 flex-wrap">
        <button type="button" id="preview-btn" class="btn btn-warning flex-fill" data-bs-toggle="tooltip" title="Preview your ad before submitting"><i class="bi bi-eye-fill"></i> Preview</button>
        <button type="submit" class="btn btn-primary flex-fill" id="submit-btn" data-bs-toggle="tooltip" title="Submit your advertisement"><span id="submit-text">Advertise Product</span> <span id="submit-spinner" class="spinner-border spinner-border-sm" style="display:none;"></span></button>
        <button type="button" id="reset-btn" class="btn btn-outline-secondary flex-fill" data-bs-toggle="tooltip" title="Clear all fields"><i class="bi bi-x-circle"></i> Reset</button>
      </div>
      <div id="result"></div>
    </form>

    <!-- Modal for preview confirmation -->
    <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmModalLabel"><i class="bi bi-check-circle-fill"></i> Confirm Advertisement</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Please review your product details in the preview below. Are you sure you want to submit this advertisement?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Edit</button>
            <button type="button" class="btn btn-primary" id="confirmSubmitBtn">Yes, Submit</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Ratings & Reviews Modal -->
    <div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="reviewModalLabel"><i class="bi bi-star-fill"></i> Rate & Review</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="rating-stars" class="mb-3 text-center">
              <i class="bi bi-star" data-star="1" style="font-size:1.5rem;cursor:pointer;"></i>
              <i class="bi bi-star" data-star="2" style="font-size:1.5rem;cursor:pointer;"></i>
              <i class="bi bi-star" data-star="3" style="font-size:1.5rem;cursor:pointer;"></i>
              <i class="bi bi-star" data-star="4" style="font-size:1.5rem;cursor:pointer;"></i>
              <i class="bi bi-star" data-star="5" style="font-size:1.5rem;cursor:pointer;"></i>
            </div>
            <textarea id="review-text" class="form-control mb-2" rows="2" placeholder="Write your review..."></textarea>
            <button id="submit-review" class="btn btn-warning btn-sm">Submit Review</button>
            <div id="reviews-list" class="mt-3 text-start"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Messaging Modal -->
    <div class="modal fade" id="msgModal" tabindex="-1" aria-labelledby="msgModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="msgModalLabel"><i class="bi bi-chat-dots"></i> Chat Demo</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="msgHistory" style="min-height:80px;max-height:150px;overflow-y:auto;border:1px solid #eee;border-radius:8px;padding:8px;margin-bottom:8px;"></div>
            <input id="msgInput" class="form-control mb-2" placeholder="Type a message..." />
            <button id="msgSendBtn" class="btn btn-info btn-sm text-white">Send</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal fade" id="payModal" tabindex="-1" aria-labelledby="payModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="payModalLabel"><i class="bi bi-credit-card"></i> Payment Demo</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>This is a payment simulation. No real transaction will occur.</p>
            <button id="payConfirmBtn" class="btn btn-success">Simulate Payment</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Feature deck interactions
    const featureSummary = document.getElementById('featureSummary');
    const featureGrid = document.getElementById('featureGrid');
    const featureTabs = document.getElementById('featureTabs');
    const featureColumns = featureGrid ? Array.from(featureGrid.querySelectorAll('[data-feature-group]')) : [];

    function activateFeatureCard(column) {
      if (!column || column.classList.contains('d-none')) return;
      featureColumns.forEach(col => {
        const card = col.querySelector('.feature-card');
        if (card) card.classList.remove('feature-card--active');
      });
      const targetCard = column.querySelector('.feature-card');
      if (targetCard) targetCard.classList.add('feature-card--active');
      const title = column.dataset.featureTitle || 'Marketplace feature';
      const copy = column.dataset.featureCopy || '';
      featureSummary.innerHTML = `<strong>${title}:</strong> ${copy}`;
    }

    featureColumns.forEach(col => {
      col.addEventListener('click', () => activateFeatureCard(col));
    });

    if (featureTabs) {
      const buttons = featureTabs.querySelectorAll('button[data-feature-target]');
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => {
            b.classList.remove('active');
            b.setAttribute('aria-pressed', 'false');
          });
          btn.classList.add('active');
          btn.setAttribute('aria-pressed', 'true');
          const target = btn.dataset.featureTarget;
          const visibleColumns = [];
          featureColumns.forEach(col => {
            col.classList.remove('animate-in');
            if (target === 'all' || col.dataset.featureGroup === target) {
              col.classList.remove('d-none');
              col.offsetWidth;
              col.classList.add('animate-in');
              visibleColumns.push(col);
            } else {
              col.classList.add('d-none');
            }
          });
          activateFeatureCard(visibleColumns[0] || featureColumns.find(c => !c.classList.contains('d-none')));
        });
      });
    }

    activateFeatureCard(featureColumns.find(col => !col.classList.contains('d-none')));

    // Enable tooltips
    document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el => new bootstrap.Tooltip(el));

    const form = document.getElementById('ad-form');
    const preview = document.getElementById('preview');
    const previewImg = document.getElementById('preview-img');
    const previewCarousel = document.getElementById('preview-carousel');
    const carouselInner = document.getElementById('carousel-inner');
    const resetBtn = document.getElementById('reset-btn');
    const previewBtn = document.getElementById('preview-btn');
    const submitBtn = document.getElementById('submit-btn');
    const submitText = document.getElementById('submit-text');
    const submitSpinner = document.getElementById('submit-spinner');
    const heroPreviewBtn = document.getElementById('heroPreviewBtn');
    const shareFacebook = document.getElementById('share-facebook');
    const shareTwitter = document.getElementById('share-twitter');
    const shareWhatsapp = document.getElementById('share-whatsapp');
    const previewWhatsapp = document.getElementById('preview-whatsapp');
    const confirmModal = new bootstrap.Modal(document.getElementById('confirmModal'));
    const confirmSubmitBtn = document.getElementById('confirmSubmitBtn');
    const previewVideoContainer = document.getElementById('preview-video-container');
    const previewVideo = document.getElementById('preview-video');

    (() => {
      'use strict';
      const forms = document.querySelectorAll('.needs-validation');
      Array.from(forms).forEach(formEl => {
        formEl.addEventListener('submit', event => {
          if (!formEl.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          formEl.classList.add('was-validated');
        }, false);
      });
    })();

    function fillPreview() {
      document.getElementById('preview-name').textContent = form['prod-name'].value;
      document.getElementById('preview-category').textContent = form['prod-category'].value;
      document.getElementById('preview-condition').textContent = form['prod-condition'].value;
      document.getElementById('preview-location').textContent = form['prod-location'].value;
      document.getElementById('preview-quantity').textContent = form['prod-quantity'].value;
      document.getElementById('preview-desc').textContent = form['prod-desc'].value;
      document.getElementById('preview-price').textContent = form['prod-price'].value;
      document.getElementById('preview-phone').textContent = form['contact-phone'].value;
      document.getElementById('preview-email').textContent = form['contact-email'].value;
      document.getElementById('preview-expiry').textContent = form['prod-expiry'].value;
      document.getElementById('preview-negotiable').style.display = form['prod-negotiable'].checked ? 'inline-block' : 'none';
      const tags = (form['prod-tags'].value || '').split(',').map(t => t.trim()).filter(Boolean);
      document.getElementById('preview-tags').innerHTML = tags.length
        ? tags.map(tag => `<span class="badge bg-secondary tag-badge">${tag}</span>`).join(' ')
        : '<span class="text-muted">No tags provided</span>';
      const phone = form['contact-phone'].value.replace(/\D/g, '');
      if (phone.length >= 9) {
        previewWhatsapp.style.display = 'inline-block';
        previewWhatsapp.href = `https://wa.me/${phone}`;
      } else {
        previewWhatsapp.style.display = 'none';
      }
      const files = form['prod-img'].files;
      previewImg.style.display = 'none';
      previewCarousel.style.display = 'none';
      carouselInner.innerHTML = '';
      if (files.length > 1) {
        Array.from(files).forEach((file, index) => {
          const reader = new FileReader();
          reader.onload = e => {
            const div = document.createElement('div');
            div.className = 'carousel-item' + (index === 0 ? ' active' : '');
            div.innerHTML = `<img src="${e.target.result}" class="d-block w-100" alt="Product Image">`;
            carouselInner.appendChild(div);
            previewCarousel.style.display = 'block';
          };
          reader.readAsDataURL(file);
        });
      } else if (files.length === 1) {
        const reader = new FileReader();
        reader.onload = e => {
          previewImg.src = e.target.result;
          previewImg.style.display = 'block';
        };
        reader.readAsDataURL(files[0]);
      }
      const videoFile = form['prod-video'].files[0];
      if (videoFile) {
        const reader = new FileReader();
        reader.onload = e => {
          previewVideo.src = e.target.result;
          previewVideoContainer.style.display = 'block';
        };
        reader.readAsDataURL(videoFile);
      } else {
        previewVideo.src = '';
        previewVideoContainer.style.display = 'none';
      }
      preview.style.display = 'block';
    }

    function isFormReady() {
      const requiredFields = [
        form['prod-name'], form['prod-category'], form['prod-desc'],
        form['prod-condition'], form['prod-location'], form['prod-expiry'],
        form['prod-price'], form['prod-quantity'], form['contact-name'],
        form['contact-phone'], form['contact-email']
      ];
      return requiredFields.every(f => f && f.value.trim());
    }

    function updateActionButtons() {
      const ready = isFormReady();
      previewBtn.disabled = !ready;
      submitBtn.disabled = !ready;
      heroPreviewBtn.disabled = !ready;
      heroPreviewBtn.classList.toggle('btn-outline-secondary', !ready);
      heroPreviewBtn.classList.toggle('btn-primary', ready);
    }

    ['prod-name','prod-category','prod-desc','prod-condition','prod-location','prod-expiry','prod-price','prod-quantity','contact-name','contact-phone','contact-email']
      .forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.addEventListener('input', updateActionButtons);
          el.addEventListener('change', updateActionButtons);
        }
      });

    updateActionButtons();

    function completePreviewFlow() {
      fillPreview();
      const previewTab = document.querySelector('#preview-tab');
      if (previewTab) previewTab.click();
      document.getElementById('result').innerHTML =
        '<div class="alert alert-info" role="alert"><i class="bi bi-eye-fill"></i> Product preview generated. Ready to advertise!</div>';
    }

    previewBtn.addEventListener('click', () => {
      if (!isFormReady() || !form.checkValidity()) {
        form.classList.add('was-validated');
        alert('Please fill in all required details before previewing.');
        return;
      }
      completePreviewFlow();
    });

    heroPreviewBtn.addEventListener('click', () => {
      if (heroPreviewBtn.disabled) {
        alert('Complete the required form details to start a preview.');
        return;
      }
      completePreviewFlow();
    });

    shareFacebook.addEventListener('click', () => alert('Share to Facebook coming soon.'));
    shareTwitter.addEventListener('click', () => alert('Share to X (Twitter) coming soon.'));
    shareWhatsapp.addEventListener('click', () => alert('Share to WhatsApp coming soon.'));

    form.addEventListener('submit', ev => {
      ev.preventDefault();
      if (!isFormReady() || !form.checkValidity()) {
        form.classList.add('was-validated');
        alert('Please fill in all required details before advertising.');
        return;
      }
      fillPreview();
      document.getElementById('preview-tab').click();
      confirmModal.show();
    });

    confirmSubmitBtn.addEventListener('click', () => {
      confirmModal.hide();
      submitSpinner.style.display = 'inline-block';
      submitText.textContent = 'Submitting...';
      setTimeout(() => {
        const tags = (form['prod-tags'].value || '').split(',').map(t => t.trim()).filter(Boolean);
        const adData = {
          name: form['prod-name'].value,
          category: form['prod-category'].value,
          condition: form['prod-condition'].value,
          location: form['prod-location'].value,
          quantity: form['prod-quantity'].value,
          desc: form['prod-desc'].value,
          price: form['prod-price'].value,
          negotiable: form['prod-negotiable'].checked,
          tags,
          expiry: form['prod-expiry'].value,
          phone: form['contact-phone'].value,
          email: form['contact-email'].value
        };
        localStorage.setItem('agribusiness_ad', JSON.stringify(adData));
        document.getElementById('result').innerHTML =
          '<div class="alert alert-success" role="alert"><i class="bi bi-check-circle-fill"></i> Product advertised and request submitted successfully!</div>';
        submitSpinner.style.display = 'none';
        submitText.textContent = 'Advertise Product';
        form.reset();
        preview.style.display = 'none';
        previewImg.style.display = 'none';
        previewCarousel.style.display = 'none';
        carouselInner.innerHTML = '';
        previewVideoContainer.style.display = 'none';
        form.classList.remove('was-validated');
        updateActionButtons();
      }, 1200);
    });

    resetBtn.addEventListener('click', () => {
      form.reset();
      form.classList.remove('was-validated');
      preview.style.display = 'none';
      document.getElementById('result').innerHTML = '';
      previewImg.style.display = 'none';
      previewCarousel.style.display = 'none';
      carouselInner.innerHTML = '';
      previewVideoContainer.style.display = 'none';
      updateActionButtons();
    });

    document.getElementById('applyFilterBtn').addEventListener('click', () => {
      alert('Filtering products by category, location, and price...');
    });

    let currentRating = 0;
    document.getElementById('openReviewBtn').addEventListener('click', () => {
      new bootstrap.Modal(document.getElementById('reviewModal')).show();
    });
    document.querySelectorAll('#rating-stars .bi-star').forEach(star => {
      star.addEventListener('click', () => {
        currentRating = parseInt(star.getAttribute('data-star'), 10);
        document.querySelectorAll('#rating-stars .bi-star').forEach((s, i) => {
          s.className = i < currentRating ? 'bi bi-star-fill text-warning' : 'bi bi-star';
        });
      });
    });
    document.getElementById('submit-review').addEventListener('click', () => {
      const reviewText = document.getElementById('review-text').value.trim();
      if (currentRating === 0 || !reviewText) return;
      const reviewsList = document.getElementById('reviews-list');
      const div = document.createElement('div');
      div.innerHTML = `<span>${'★'.repeat(currentRating)}</span> ${reviewText}`;
      reviewsList.appendChild(div);
      document.getElementById('review-text').value = '';
      currentRating = 0;
      document.querySelectorAll('#rating-stars .bi-star').forEach(s => s.className = 'bi bi-star');
    });

    const sampleMessages = [
      { user: 'Jane', text: 'Is this tractor still available?' },
      { user: 'Paul', text: 'Can you deliver to Gulu?' },
      { user: 'Admin', text: 'Welcome to AGRIMAC chat!' }
    ];
    document.getElementById('msgCount').textContent = sampleMessages.length;
    document.getElementById('recentMessages').innerHTML = sampleMessages.map(m =>
      `<div class="text-start small mb-1"><span class="fw-bold">${m.user}:</span> ${m.text}</div>`
    ).join('');

    document.getElementById('openChatBtn').addEventListener('click', () => {
      const modal = new bootstrap.Modal(document.getElementById('msgModal'));
      const history = document.getElementById('msgHistory');
      history.innerHTML = sampleMessages
        .map(m => `<div><strong>${m.user}:</strong> ${m.text}</div>`)
        .join('');
      modal.show();
    });

    document.getElementById('msgSendBtn').addEventListener('click', () => {
      const val = document.getElementById('msgInput').value.trim();
      if (!val) return;
      const history = document.getElementById('msgHistory');
      const entry = document.createElement('div');
      entry.innerHTML = `<strong>You:</strong> ${val}`;
      history.appendChild(entry);
      document.getElementById('msgInput').value = '';
      history.scrollTo({ top: history.scrollHeight, behavior: 'smooth' });
    });

    document.getElementById('payBtn').addEventListener('click', () => {
      new bootstrap.Modal(document.getElementById('payModal')).show();
    });
    document.getElementById('payConfirmBtn').addEventListener('click', () => {
      alert('Payment simulated! Thank you for your order.');
      bootstrap.Modal.getInstance(document.getElementById('payModal')).hide();
    });

    const recentReviews = [
      { user: 'Jane', rating: 5, text: 'Excellent product!' },
      { user: 'Paul', rating: 4, text: 'Works well, fast delivery.' },
      { user: 'Grace', rating: 5, text: 'Highly recommended.' }
    ];
    document.getElementById('avgRating').textContent = (
      recentReviews.reduce((sum, r) => sum + r.rating, 0) / recentReviews.length
    ).toFixed(1);
    document.getElementById('recentReviews').innerHTML = recentReviews.map(r =>
      `<div class="text-start small mb-1"><span class="fw-bold">${r.user}:</span> <span class="text-warning">${'★'.repeat(r.rating)}</span> ${r.text}</div>`
    ).join('');
  </script>
</body>
</html>
